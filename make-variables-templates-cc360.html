<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Submission</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="api-key.js"></script>
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-xl mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-2xl font-bold mb-4">Submit Text</h1>
        <textarea id="inputText" class="w-full p-2 border border-gray-300 rounded mb-4" rows="4" placeholder="Write your text here..."></textarea>
        <button id="submitButton" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">Submit</button>
        <div id="responseContainer" class="mt-4 p-4 border border-gray-300 rounded bg-gray-50"></div>
    </div>

    <div class="container mx-auto mt-10">
        <div class="mb-4">
            <label for="template-name" class="block text-sm font-medium text-gray-700">Template Name</label>
            <input type="text" id="template-name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <table class="min-w-full bg-white shadow-md rounded-lg">
            <thead>
                <tr>
                    <th class="px-6 py-3 border-b-2 border-gray-300 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Key</th>
                    <th class="px-6 py-3 border-b-2 border-gray-300 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Value</th>
                    <th class="px-6 py-3 border-b-2 border-gray-300"></th>
                </tr>
            </thead>
            <tbody id="key-value-table">
                <!-- Dynamic rows will be inserted here -->
            </tbody>
        </table>
        <div class="mt-4 flex space-x-2">
            <button id="add-row" class="bg-green-500 text-white px-3 py-2 rounded-md shadow hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500">+</button>
            <button id="submit" class="bg-blue-500 text-white px-3 py-2 rounded-md shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">Submit</button>
        </div>
        
        <!-- Modal -->
        <div id="delete-modal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
            <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
                <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
                <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                    <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                        <div class="sm:flex sm:items-start">
                            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                                <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">Delete Key-Value Pair</h3>
                                <div class="mt-2">
                                    <p class="text-sm text-gray-500" id="modal-text"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                        <button type="button" id="confirm-delete" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm">Delete</button>
                        <button type="button" id="cancel-delete" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    const apiKey = window.OPENAI_API_KEY;

    document.getElementById('submitButton').addEventListener('click', async function() {
        const inputText = document.getElementById('inputText').value;
        const responseContainer = document.getElementById('responseContainer');
        const submitButton = document.getElementById('submitButton');

        submitButton.textContent = 'Submitting...';
        submitButton.disabled = true;

        try {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-4o-2024-05-13',
                    messages: [
                        {
                            role: 'system',
                            content: "You are an expert at naming variables. Please review the website copy above and rewrite the website copy but in key value pairs where the keys explain what the text is. Ensure that there are no nested arrays or dictionaries. and that the values are strings not lists"
                        },
                        {
                            role: 'user',
                            content: `EXAMPLE OUTPUT: {
                                "get_this_amazing_outcome_without_this_painful_thing": "Avoid these 5 interior photography & editing mistakes and build a 6-figure business",
                                "headline_to_establish_credibility_and_summarize_course": "The top-rated online course for Architectural & Interior Photography",
                                "painpoint_without_course_1": "Difficulty in finding clients",
                                "painpoint_without_course_2": "Uncertainty in lighting the scene",
                                "painpoint_without_course_3": "Your edits appear flat or muddy",
                                "painpoint_without_course_4": "You don't know what gear to buy",
                                "painpoint_without_course_5": "Not sure how to scale to 6 figures",
                                "painpoint_without_course_6": "You're not getting repeat clients",
                                "realized_desire_after_course_completion_1": "Use our marketing framework to have consistent new leads",
                                "realized_desire_after_course_completion_2": "Nail your shot with confidence every time",
                                "realized_desire_after_course_completion_3": "Cinematic, crystal clear shots that pop",
                                "realized_desire_after_course_completion_4": "Get all the best gear for under $1,000",
                                "realized_desire_after_course_completion_5": "Discover how to upsell & license multiple 5-figure clients",
                                "realized_desire_after_course_completion_6": "Become the GO TO Photographer",
                                "what_you_will_learn_in_the_course": "Learn to Frame, Light & Edit Interior Photos That SELL!",
                                "why_you_need_this_preheadline": "WHY THIS Training is Essential",
                                "included_in_course_header": "Breakdown of Course Content",
                                "testimonial_text_1": "As a busy property photographer in the U.K., this course has been invaluable. Brad's expertise and clear instructions have significantly improved the quality of my work. I'd recommend it to anyone looking to enhance their photography skills.",
                                "testimonial_name_1": "Peter Hawley",
                                "testimonial_text_2": "As a real estate agent, I've always struggled with getting the right photos for my listings. This course has been a game changer for me. I can't recommend this course enough for anyone in the real estate industry.",
                                "testimonial_name_2": "Sophia Martinez",
                                "testimonial_text_3": "I'm a freelance photographer and this course has helped me improve my property photography and opened up a new revenue stream for me. Brad's teaching style is easy to follow and the course is packed with practical tips. Highly recommended for any photographer looking to expand their skill set.",
                                "testimonial_name_3": "Liam Thompson",
                                "course_offer_headline": "Master Architectural & Interiors Photography",
                                "course_offer_description": "Elevate your images and photography business with our step-by-step video course",
                                "included_in_offer_1": "Instant Access to stream 30+ video lessons",
                                "included_in_offer_2": "Links to Recommended Gear + Discount Codes",
                                "included_in_offer_3": "Private Community access to learn & grow together",
                                "included_in_offer_4": "Access to FUTURE TRAINING within this course",
                                "who_is_this_course_for": "This course is for any Photographer who wants to improve their Architectural & Interior Photos",
                                "made_for_1": "REAL ESTATE PHOTOGRAPHERS",
                                "made_for_2": "INTERIOR DESIGN PHOTOGRAPHERS",
                                "made_for_3": "TRAVEL PHOTOGRAPHERS LOOKING TO WORK WITH HOTELS",
                                "made_for_4": "ARCHITECTURAL PHOTOGRAPHERS",
                                "made_for_5": "COMMERCIAL PHOTOGRAPHERS",
                                "made_for_6": "RESTAURANT PHOTOGRAPHER",
                                "made_for_7": "HOSPITAL PHOTOGRAPHERS",
                                "made_for_8": "AIRBNB PHOTOGRAPHERS",
                                "faq_answer_1": "Yes! Our marketing & business trainings will give you an inside look at how I have been able to do $200K a year as a solo shooter providing services to Hospitality, Commercial & Residential Property industries.",
                                "faq_answer_2": "This course is for Photographers who are looking to generate a full time income shooting Architectural & Interior Photography. You should already have the basic understanding of camera settings such as ISO, Aperture, Shutter Speed, White Balance. We may do a beginner photography course in the future but this course is for intermediate to advanced photographers.",
                                "faq_answer_3": "What sets this course apart is the lack of gatekeeping and fluff when it comes to how to actually run a photography business. I am going to be opening up my backend. Showing how I bid some of my largest jobs, how I get clients and other ways to make additional income with different types of licensing.",
                                "faq_title_1": "Do you teach marketing?",
                                "faq_title_2": "What level of photography do I need to be at to take this course?",
                                "faq_title_3": "What makes this course different from others?",
                                "instructor_achievement_1": "Recognized as one of the top architectural photographers in the country.",
                                "instructor_achievement_2": "His work has been featured in numerous high-profile publications.",
                                "instructor_achievement_3": "Successfully mentored over 1,000 students.",
                                "instructor_achievement_4": "Won several awards for his stunning photography.",
                                "instructor_achievement_5": "Created a course that has been rated 5 stars by its users.",
                                "instructor_achievement_6": "Built a thriving online community of photographers.",
                                "instructor_epiphany": "Realized that many aspiring photographers were making the same mistakes he once did. He saw a gap in the market for a comprehensive course that not only taught the technical aspects of photography but also the business side of things. This led him to create the #1 online course for learning architectural and interior photography.",
                                "instructor_results_text": "His students have gone on to launch successful careers in the industry, with many of them earning six-figure incomes. His course has been praised for its practical approach and in-depth content.",
                                "introduction_to_instructor": "A seasoned professional in the field of architectural and interior photography. With over 15 years of experience, he has honed his skills and developed a keen eye for capturing the essence of a space. His passion for photography began at a young age and has since grown into a successful career.",
                                "hero_text_promise_in_short_timeframe": "10X The Quality Of Your Videos In Just 10 Days!",
                                "business_short_name": "Real Estate Photography Pro",
                                "course_module_1": "CAMERA EQUIPMENT",
                                "course_module_2": "CAMERA SETTINGS",
                                "course_module_3": "LIGHTING 101",
                                "course_module_4": "COMPOSITION",
                                "course_module_5": "CAMERA ANGLES",
                                "course_module_6": "CAMERA MOVEMENTS",
                                "course_module_7": "FOCAL LENGTH",
                                "course_module_8": "AUDIO",
                                "course_module_summary_1": "What gear do I buy? What's the best camera for a beginner and why?",
                                "course_module_summary_2": "How to dial your camera settings in ANY scenario to achieve that coveted cinematic look.",
                                "course_module_summary_3": "How do I get my footage to POP off the screen with artificial and natural lighting techniques?",
                                "course_module_summary_4": "How do I compose an image to reach its peak aesthetic potential with composition hacks?",
                                "course_module_summary_5": "How I use the 'Rule of 5' to achieve maximum engagement & fluidity in my edits?",
                                "course_module_summary_6": "My personal favorite gimbal, handheld, & tripod movements I use daily.",
                                "course_module_summary_7": "How and when to use any given camera lens by understanding how focal length affects your image.",
                                "course_module_summary_8": "How I bring my edits to life with immersive sound design and music.",
                                "course_module_img_1": "Professional photography equipment arranged on a wooden surface, featuring a prominent Canon camera with a red-ringed L-series lens attached, indicating high quality. Various camera bodies and a range of lenses with different sizes and functions are scattered behind it, some with caps on. In the foreground, a monopod is laid across, suggesting mobility and the need for stabilization in active shooting scenarios. The collection implies the gear is for a professional or enthusiast photographer with a preference for Canon brand and a requirement for diverse shooting conditions.",
                                "course_module_img_2": "Split-screen image demonstrating different camera shutter speeds. On the left, a motion-blurred hand is shown, labeled '1/50 SHUTTER', illustrating a slower shutter speed that captures movement, commonly used for a cinematic look. On the right, the same hand is sharply in focus, labeled '1/1000 SHUTTER', showing the effect of a fast shutter speed that freezes motion. Both images share a background with geometric shapes and a model on a table, indicating a tutorial setup.",
                                "course_module_img_3": "Instructional image showing a man's face divided into quadrants to demonstrate lighting effects. The left side of his face is underlit, creating shadows, with 'DARK' labeled on the upper and lower sections, while the right side is brightly lit, with 'BRIGHT' labeled on the corresponding sections, emphasizing the contrast. The technique highlights the impact of lighting on mood and character portrayal in visual media. The background is a subtle blue, focusing attention on the lighting on the subject's face.",
                                "course_module_img_4": "Photographic composition tutorial image featuring a wooden pier extending into the sea, with the rule of thirds grid overlaid. The horizon coincides with the top third line, and the pier aligns with the left vertical line, guiding the eye to the vanishing point. The time is sunrise or sunset, indicated by the warm orange glow on the horizon against a blue sky. Red overlays highlight the horizon and the left vertical third, emphasizing these compositional lines. The image is likely part of an educational series on the principles of composition.",
                                "course_module_img_5": "Collage of nine film and photography shot types featuring a man in various frames for educational purposes. 'LONG' shows a man in full-body view; 'MEDIUM' presents a waist-up shot; 'COWBOY' captures him from the thighs up; 'LOW' from a low angle; 'HIGH' from above; 'TIGHT' is a close-up of his face; 'DETAIL' zooms in on his eye; 'DUTCH' tilts the angle for dramatic effect; and 'POV' mimics the man's point of view. Text overlays such as 'Effective Communication' and 'Mastering Net Play with Effective Volleys' suggest a metaphorical or instructional usage beyond film technique.",
                                "course_module_img_6": "Image of a man outdoors, looking upwards with concentration as he handles a piece of equipment, possibly a camera or tool, above his head. He wears a casual grey tank top, a black headband, and has a focused expression. The background is blurred but shows tropical trees and a sunny sky, indicating a warm, bright day. Text overlaid on the image, 'Leadership Skills' and 'Developing Quick and Agile Footwork,' suggests the image might be used metaphorically in a leadership or agility training context.",
                                "course_module_img_7": "Audio recording equipment spread out on a wooden surface. Central to the composition is a 'RODE' branded microphone with its distinct windshield, indicating a setup for high-quality sound capture. Adjacent to it are professional Sennheiser headphones, commonly used for precise audio monitoring. Various audio interfaces, cables, and another microphone with a cylindrical shape can also be seen, suggesting a complex and professional audio setup. The inclusion of the text 'Time Management' and 'Strategies for Singles and Doubles Matches' in the image may imply a thematic connection to efficiency in handling audio equipment for production tasks, though these elements seem unrelated to the actual items displayed.",
                                "course_module_img_8": "Close-up of a video editor's hands working on a professional mixing console with illuminated LED buttons and sliders, and a computer mouse on a desk. The background is a softly blurred computer monitor displaying a video editing software interface, indicative of a complex editing process. The focus on the hands and the equipment foregrounds the meticulous task of video editing. Overlay text 'Success Mindset' and 'Mental Exercises to Boost On-Court Performance' suggest the image may be used in a context emphasizing the mental focus and precision required for both video editing and sports performance.",
                                "upsell_modules_1": "Our entire Equipment & Gear Module (17 Videos)",
                                "course_emoji": "🎥"
                            }`
                        },
{
                                    role: 'user',
                                    content: inputText
                                }
                    ]
                })
            });

            const data = await response.json();
            const resultText = data.choices[0].message.content;
            console.log(resultText,'resultText');

            // Extract JSON content from the response text
            let jsonString = '';
            const jsonStart = resultText.indexOf('```json');
            const jsonEnd = resultText.indexOf('```', jsonStart + 6);
            if (jsonStart !== -1 && jsonEnd !== -1) {
                jsonString = resultText.substring(jsonStart + 6, jsonEnd).trim();
            } else {
                jsonString = resultText;
            }

            responseContainer.innerHTML = `<pre class="whitespace-pre-wrap">${jsonString}</pre>`;

            // Parse the jsonString to JSON
            let keyValueData;
            try {
                keyValueData = JSON.parse(jsonString);
            } catch (parseError) {
                console.error('JSON Parse error:', parseError);
                responseContainer.innerHTML = `<p class="text-red-500">Error parsing JSON: ${parseError.message}</p>`;
                return;
            }

            // Populate the key-value pairs in the table
            renderTable(keyValueData);
        } catch (error) {
            responseContainer.innerHTML = `<p class="text-red-500">Error: ${error.message}</p>`;
        } finally {
            submitButton.textContent = 'Submit';
            submitButton.disabled = false;
        }
    });

    function renderTable(keyValueData) {
        const tableBody = document.getElementById('key-value-table');
        tableBody.innerHTML = '';
        for (const [key, value] of Object.entries(keyValueData)) {
            const row = createTableRow(key, value);
            tableBody.appendChild(row);
        }
    }

    function createTableRow(key = '', value = '') {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="text" value="${key}" class="key-input w-full px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <input type="text" value="${value}" class="value-input w-full px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                <button class="delete-row text-red-600 hover:text-red-900">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </td>
        `;
        return row;
    }

    function addRow() {
        const tableBody = document.getElementById('key-value-table');
        const newRow = createTableRow();
        tableBody.appendChild(newRow);
    }

    function handleDeleteRow(event) {
        const row = event.target.closest('tr');
        const keyInput = row.querySelector('.key-input').value;
        const valueInput = row.querySelector('.value-input').value;
        const modal = document.getElementById('delete-modal');
        const modalText = document.getElementById('modal-text');
        modalText.textContent = `Are you sure you want to delete ${keyInput}: ${valueInput}?`;
        modal.classList.remove('hidden');
        
        document.getElementById('confirm-delete').onclick = function() {
            row.remove();
            modal.classList.add('hidden');
        };

        document.getElementById('cancel-delete').onclick = function() {
            modal.classList.add('hidden');
        };
    }

    function handleSubmit() {
        const rows = document.querySelectorAll('#key-value-table tr');
        const data = {};
        let hasError = false;

        rows.forEach(row => {
            const key = row.querySelector('.key-input').value;
            const value = row.querySelector('.value-input').value;
            if (key && value) {
                data[key] = value;
            } else {
                hasError = true;
                row.querySelector('.key-input').classList.add('border-red-500');
                row.querySelector('.value-input').classList.add('border-red-500');
            }
        });

        if (hasError) {
            alert('Please fill in all key-value pairs.');
            return;
        }

        const submitButton = document.getElementById('submit');
        submitButton.textContent = 'Submitting...';
        submitButton.disabled = true;

        fetch('http://localhost:5000', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
        .then(response => {
            if (response.ok) {
                alert('Data submitted successfully!');
            } else {
                throw new Error('Network response was not ok.');
            }
        })
        .catch(error => {
            console.error('There was a problem with the fetch operation:', error);
            alert('Failed to submit data. Please try again.');
        })
        .finally(() => {
            submitButton.textContent = 'Submit';
            submitButton.disabled = false;
        });
    }

    document.getElementById('add-row').addEventListener('click', addRow);
    document.getElementById('submit').addEventListener('click', handleSubmit);
    document.getElementById('key-value-table').addEventListener('click', function(event) {
        if (event.target.closest('.delete-row')) {
            handleDeleteRow(event);
        }
    });

    // Initial render with empty data
    renderTable({});
});
    </script>
</body>
</html>
